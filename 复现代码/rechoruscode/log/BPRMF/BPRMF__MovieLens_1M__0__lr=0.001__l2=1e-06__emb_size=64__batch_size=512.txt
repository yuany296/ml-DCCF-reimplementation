INFO:root:Namespace(model_name='BPRMF', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-12-29 19:09:51 ---------------------------------------------
INFO:root:
===================================
 Arguments          | Values       
===================================
 batch_size         | 512         
 data_appendix      |             
 dataset            | MovieLens_1M
 dropout            | 0           
 early_stop         | 10          
 emb_size           | 64          
 epoch              | 100         
 eval_batch_size    | 512         
 gpu                | 0           
 l2                 | 1e-06       
 lr                 | 0.001       
 main_metric        | NDCG@10     
 num_neg            | 1           
 num_workers        | 5           
 optimizer          | Adam        
 random_seed        | 0           
 save_final_results | 1           
 test_all           | 0           
 topk               | 5,10,20,50  
===================================
INFO:root:Device: cuda
INFO:root:Load corpus from data/MovieLens_1M/BaseReader.pkl
INFO:root:#params: 639616
INFO:root:BPRMF(
  (u_embeddings): Embedding(6041, 64)
  (i_embeddings): Embedding(3953, 64)
)
INFO:root:Test Before Training: (HR@5:0.0522,NDCG@5:0.0297,HR@10:0.0981,NDCG@10:0.0443,HR@20:0.2007,NDCG@20:0.0699,HR@50:0.4971,NDCG@50:0.1277)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.4132 [3.1 s]	dev=(HR@10:0.4843,NDCG@10:0.2652) test=(HR@5:0.3085,NDCG@5:0.2015) [0.3 s] *
INFO:root:Epoch 2     loss=0.2550 [3.1 s]	dev=(HR@10:0.5079,NDCG@10:0.2776) [0.2 s] *
INFO:root:Epoch 3     loss=0.2292 [3.1 s]	dev=(HR@10:0.5246,NDCG@10:0.2851) [0.2 s] *
INFO:root:Epoch 4     loss=0.2137 [3.1 s]	dev=(HR@10:0.5463,NDCG@10:0.3000) [0.2 s] *
INFO:root:Epoch 5     loss=0.2003 [3.1 s]	dev=(HR@10:0.5614,NDCG@10:0.3087) [0.2 s] *
INFO:root:Epoch 6     loss=0.1891 [3.1 s]	dev=(HR@10:0.5854,NDCG@10:0.3215) test=(HR@5:0.3755,NDCG@5:0.2463) [0.3 s] *
INFO:root:Epoch 7     loss=0.1792 [3.1 s]	dev=(HR@10:0.6036,NDCG@10:0.3320) [0.2 s] *
INFO:root:Epoch 8     loss=0.1708 [3.1 s]	dev=(HR@10:0.6141,NDCG@10:0.3415) [0.2 s] *
INFO:root:Epoch 9     loss=0.1633 [3.1 s]	dev=(HR@10:0.6275,NDCG@10:0.3509) [0.2 s] *
INFO:root:Epoch 10    loss=0.1574 [3.0 s]	dev=(HR@10:0.6333,NDCG@10:0.3562) [0.2 s] *
INFO:root:Epoch 11    loss=0.1518 [3.1 s]	dev=(HR@10:0.6384,NDCG@10:0.3591) test=(HR@5:0.4196,NDCG@5:0.2766) [0.3 s] *
INFO:root:Epoch 12    loss=0.1476 [3.2 s]	dev=(HR@10:0.6436,NDCG@10:0.3674) [0.2 s] *
INFO:root:Epoch 13    loss=0.1432 [3.1 s]	dev=(HR@10:0.6542,NDCG@10:0.3748) [0.2 s] *
INFO:root:Epoch 14    loss=0.1406 [3.1 s]	dev=(HR@10:0.6580,NDCG@10:0.3768) [0.2 s] *
INFO:root:Epoch 15    loss=0.1370 [3.1 s]	dev=(HR@10:0.6625,NDCG@10:0.3791) [0.2 s] *
INFO:root:Epoch 16    loss=0.1345 [3.1 s]	dev=(HR@10:0.6671,NDCG@10:0.3824) test=(HR@5:0.4409,NDCG@5:0.2940) [0.4 s] *
INFO:root:Epoch 17    loss=0.1309 [3.2 s]	dev=(HR@10:0.6724,NDCG@10:0.3847) [0.2 s] *
INFO:root:Epoch 18    loss=0.1279 [3.1 s]	dev=(HR@10:0.6734,NDCG@10:0.3893) [0.2 s] *
INFO:root:Epoch 19    loss=0.1259 [3.1 s]	dev=(HR@10:0.6779,NDCG@10:0.3915) [0.2 s] *
INFO:root:Epoch 20    loss=0.1225 [3.0 s]	dev=(HR@10:0.6822,NDCG@10:0.3930) [0.2 s] *
INFO:root:Epoch 21    loss=0.1211 [3.1 s]	dev=(HR@10:0.6872,NDCG@10:0.3978) test=(HR@5:0.4674,NDCG@5:0.3102) [0.3 s] *
INFO:root:Epoch 22    loss=0.1180 [3.0 s]	dev=(HR@10:0.6855,NDCG@10:0.3961) [0.2 s]
INFO:root:Epoch 23    loss=0.1154 [3.1 s]	dev=(HR@10:0.6872,NDCG@10:0.3962) [0.2 s]
INFO:root:Epoch 24    loss=0.1142 [3.1 s]	dev=(HR@10:0.6896,NDCG@10:0.3976) [0.2 s]
INFO:root:Epoch 25    loss=0.1114 [3.1 s]	dev=(HR@10:0.6920,NDCG@10:0.3998) [0.2 s] *
INFO:root:Epoch 26    loss=0.1094 [3.2 s]	dev=(HR@10:0.6926,NDCG@10:0.4013) test=(HR@5:0.4694,NDCG@5:0.3141) [0.3 s] *
INFO:root:Epoch 27    loss=0.1077 [3.1 s]	dev=(HR@10:0.6946,NDCG@10:0.4036) [0.2 s] *
INFO:root:Epoch 28    loss=0.1049 [3.1 s]	dev=(HR@10:0.6984,NDCG@10:0.4065) [0.2 s] *
INFO:root:Epoch 29    loss=0.1034 [3.1 s]	dev=(HR@10:0.6994,NDCG@10:0.4091) [0.2 s] *
INFO:root:Epoch 30    loss=0.1019 [3.1 s]	dev=(HR@10:0.7012,NDCG@10:0.4099) [0.2 s] *
INFO:root:Epoch 31    loss=0.1000 [3.0 s]	dev=(HR@10:0.7059,NDCG@10:0.4110) test=(HR@5:0.4772,NDCG@5:0.3201) [0.3 s] *
INFO:root:Epoch 32    loss=0.0985 [3.1 s]	dev=(HR@10:0.7032,NDCG@10:0.4102) [0.2 s]
INFO:root:Epoch 33    loss=0.0966 [3.1 s]	dev=(HR@10:0.7036,NDCG@10:0.4123) [0.2 s] *
INFO:root:Epoch 34    loss=0.0951 [3.0 s]	dev=(HR@10:0.7060,NDCG@10:0.4145) [0.2 s] *
INFO:root:Epoch 35    loss=0.0933 [3.2 s]	dev=(HR@10:0.7047,NDCG@10:0.4119) [0.2 s]
INFO:root:Epoch 36    loss=0.0932 [3.0 s]	dev=(HR@10:0.7036,NDCG@10:0.4134) test=(HR@5:0.4822,NDCG@5:0.3245) [0.3 s]
INFO:root:Epoch 37    loss=0.0916 [3.1 s]	dev=(HR@10:0.7060,NDCG@10:0.4157) [0.2 s] *
INFO:root:Epoch 38    loss=0.0906 [3.1 s]	dev=(HR@10:0.7056,NDCG@10:0.4156) [0.2 s]
INFO:root:Epoch 39    loss=0.0887 [3.1 s]	dev=(HR@10:0.7082,NDCG@10:0.4140) [0.2 s]
INFO:root:Epoch 40    loss=0.0882 [3.0 s]	dev=(HR@10:0.7062,NDCG@10:0.4129) [0.2 s]
INFO:root:Epoch 41    loss=0.0869 [3.1 s]	dev=(HR@10:0.7095,NDCG@10:0.4162) test=(HR@5:0.4865,NDCG@5:0.3277) [0.4 s] *
INFO:root:Epoch 42    loss=0.0867 [3.1 s]	dev=(HR@10:0.7099,NDCG@10:0.4168) [0.2 s] *
INFO:root:Epoch 43    loss=0.0845 [3.0 s]	dev=(HR@10:0.7072,NDCG@10:0.4167) [0.2 s]
INFO:root:Epoch 44    loss=0.0848 [3.2 s]	dev=(HR@10:0.7095,NDCG@10:0.4159) [0.2 s]
INFO:root:Epoch 45    loss=0.0839 [3.1 s]	dev=(HR@10:0.7110,NDCG@10:0.4161) [0.2 s]
INFO:root:Epoch 46    loss=0.0826 [3.0 s]	dev=(HR@10:0.7109,NDCG@10:0.4174) test=(HR@5:0.4895,NDCG@5:0.3279) [0.3 s] *
INFO:root:Epoch 47    loss=0.0822 [3.1 s]	dev=(HR@10:0.7099,NDCG@10:0.4185) [0.2 s] *
INFO:root:Epoch 48    loss=0.0814 [3.2 s]	dev=(HR@10:0.7087,NDCG@10:0.4183) [0.2 s]
INFO:root:Epoch 49    loss=0.0811 [3.0 s]	dev=(HR@10:0.7070,NDCG@10:0.4180) [0.2 s]
INFO:root:Epoch 50    loss=0.0803 [3.1 s]	dev=(HR@10:0.7085,NDCG@10:0.4202) [0.2 s] *
INFO:root:Epoch 51    loss=0.0788 [3.1 s]	dev=(HR@10:0.7059,NDCG@10:0.4190) test=(HR@5:0.4885,NDCG@5:0.3287) [0.3 s]
INFO:root:Epoch 52    loss=0.0786 [3.0 s]	dev=(HR@10:0.7080,NDCG@10:0.4200) [0.2 s]
INFO:root:Epoch 53    loss=0.0783 [3.2 s]	dev=(HR@10:0.7080,NDCG@10:0.4209) [0.2 s] *
INFO:root:Epoch 54    loss=0.0773 [3.1 s]	dev=(HR@10:0.7075,NDCG@10:0.4200) [0.2 s]
INFO:root:Epoch 55    loss=0.0769 [3.1 s]	dev=(HR@10:0.7109,NDCG@10:0.4207) [0.2 s]
INFO:root:Epoch 56    loss=0.0767 [3.1 s]	dev=(HR@10:0.7115,NDCG@10:0.4210) test=(HR@5:0.4878,NDCG@5:0.3309) [0.3 s] *
INFO:root:Epoch 57    loss=0.0758 [3.1 s]	dev=(HR@10:0.7060,NDCG@10:0.4196) [0.2 s]
INFO:root:Epoch 58    loss=0.0752 [3.1 s]	dev=(HR@10:0.7060,NDCG@10:0.4187) [0.2 s]
INFO:root:Epoch 59    loss=0.0755 [3.1 s]	dev=(HR@10:0.7104,NDCG@10:0.4212) [0.2 s] *
INFO:root:Epoch 60    loss=0.0745 [3.1 s]	dev=(HR@10:0.7112,NDCG@10:0.4224) [0.2 s] *
INFO:root:Epoch 61    loss=0.0750 [3.0 s]	dev=(HR@10:0.7109,NDCG@10:0.4218) test=(HR@5:0.4911,NDCG@5:0.3313) [0.3 s]
INFO:root:Epoch 62    loss=0.0739 [3.2 s]	dev=(HR@10:0.7097,NDCG@10:0.4212) [0.2 s]
INFO:root:Epoch 63    loss=0.0735 [3.1 s]	dev=(HR@10:0.7095,NDCG@10:0.4215) [0.2 s]
INFO:root:Epoch 64    loss=0.0729 [3.0 s]	dev=(HR@10:0.7100,NDCG@10:0.4211) [0.2 s]
INFO:root:Epoch 65    loss=0.0726 [3.1 s]	dev=(HR@10:0.7100,NDCG@10:0.4229) [0.2 s] *
INFO:root:Epoch 66    loss=0.0725 [3.2 s]	dev=(HR@10:0.7074,NDCG@10:0.4215) test=(HR@5:0.4898,NDCG@5:0.3297) [0.3 s]
INFO:root:Epoch 67    loss=0.0722 [3.0 s]	dev=(HR@10:0.7067,NDCG@10:0.4226) [0.2 s]
INFO:root:Epoch 68    loss=0.0718 [3.1 s]	dev=(HR@10:0.7069,NDCG@10:0.4210) [0.2 s]
INFO:root:Epoch 69    loss=0.0716 [3.1 s]	dev=(HR@10:0.7090,NDCG@10:0.4239) [0.2 s] *
INFO:root:Epoch 70    loss=0.0711 [3.1 s]	dev=(HR@10:0.7079,NDCG@10:0.4211) [0.2 s]
INFO:root:Epoch 71    loss=0.0711 [3.2 s]	dev=(HR@10:0.7107,NDCG@10:0.4214) test=(HR@5:0.4918,NDCG@5:0.3306) [0.4 s]
INFO:root:Epoch 72    loss=0.0715 [3.1 s]	dev=(HR@10:0.7095,NDCG@10:0.4206) [0.2 s]
INFO:root:Epoch 73    loss=0.0709 [3.1 s]	dev=(HR@10:0.7114,NDCG@10:0.4216) [0.2 s]
INFO:root:Epoch 74    loss=0.0708 [3.1 s]	dev=(HR@10:0.7109,NDCG@10:0.4225) [0.2 s]
INFO:root:Epoch 75    loss=0.0705 [3.1 s]	dev=(HR@10:0.7085,NDCG@10:0.4225) [0.2 s]
INFO:root:Epoch 76    loss=0.0697 [3.0 s]	dev=(HR@10:0.7099,NDCG@10:0.4199) test=(HR@5:0.4920,NDCG@5:0.3330) [0.3 s]
INFO:root:Epoch 77    loss=0.0703 [3.0 s]	dev=(HR@10:0.7090,NDCG@10:0.4203) [0.2 s]
INFO:root:Epoch 78    loss=0.0698 [3.1 s]	dev=(HR@10:0.7064,NDCG@10:0.4208) [0.2 s]
INFO:root:Early stop at 78 based on dev result.
INFO:root:
Best Iter(dev)=   69	 dev=(HR@10:0.7090,NDCG@10:0.4239) [261.7 s] 
INFO:root:Load model from ../model/BPRMF/BPRMF__MovieLens_1M__0__lr=0.001__l2=1e-06__emb_size=64__batch_size=512.pt
INFO:root:
Dev  After Training: (HR@5:0.5322,NDCG@5:0.3666,HR@10:0.7090,NDCG@10:0.4239,HR@20:0.8691,NDCG@20:0.4646,HR@50:0.9776,NDCG@50:0.4867)
INFO:root:
Test After Training: (HR@5:0.4888,NDCG@5:0.3284,HR@10:0.6742,NDCG@10:0.3884,HR@20:0.8461,NDCG@20:0.4320,HR@50:0.9707,NDCG@50:0.4572)
INFO:root:Saving top-100 recommendation results to: ../log/BPRMF/BPRMF__MovieLens_1M__0__lr=0/rec-BPRMF-dev.csv
INFO:root:dev Prediction results saved!
INFO:root:Saving top-100 recommendation results to: ../log/BPRMF/BPRMF__MovieLens_1M__0__lr=0/rec-BPRMF-test.csv
INFO:root:test Prediction results saved!
INFO:root:
--------------------------------------------- END: 2025-12-29 19:14:17 ---------------------------------------------
